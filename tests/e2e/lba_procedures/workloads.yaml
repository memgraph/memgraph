args: &args
  - "--bolt-port=7687"
  - "--log-level=TRACE"
  - "--schema-info-enabled=true"

query_modules_setup_queries: &query_modules_setup_queries
  - "CREATE USER admin IDENTIFIED BY 'test';"
  - "GRANT ALL PRIVILEGES TO admin"
  - "GRANT DATABASE * TO admin"
  - "CREATE USER user IDENTIFIED BY 'test';"
  - "GRANT ALL PRIVILEGES TO user"
  - "GRANT DATABASE * TO user"

show_privileges_setup_queries: &show_privileges_setup_queries
  - "Create User Josip;"
  - "GRANT READ ON NODES CONTAINING LABELS :Label1 TO Josip;"
  - "GRANT NOTHING ON NODES CONTAINING LABELS :Label2 TO Josip;"
  - "GRANT UPDATE ON NODES CONTAINING LABELS :Label3 TO Josip;"
  - "GRANT READ ON NODES CONTAINING LABELS :Label4 TO Josip;"
  - "GRANT CREATE ON NODES CONTAINING LABELS :Label5 TO Josip;"
  - "GRANT DELETE ON NODES CONTAINING LABELS :Label5 TO Josip;"
  - "GRANT UPDATE ON NODES CONTAINING LABELS :Label6 TO Josip;"
  - "GRANT CREATE ON NODES CONTAINING LABELS :Label7 TO Josip;"
  - "GRANT DELETE ON NODES CONTAINING LABELS :Label7 TO Josip;"
  - "GRANT NOTHING ON NODES CONTAINING LABELS :Label7 TO Josip;"
  - "Create User Boris;"
  - "Grant Auth TO Boris;"
  - "GRANT READ ON NODES CONTAINING LABELS :Label1 TO Boris;"
  - "GRANT NOTHING ON NODES CONTAINING LABELS :Label2 TO Boris;"
  - "GRANT UPDATE ON NODES CONTAINING LABELS :Label3 TO Boris;"
  - "GRANT READ ON NODES CONTAINING LABELS :Label4 TO Boris;"
  - "GRANT CREATE ON NODES CONTAINING LABELS :Label5 TO Boris;"
  - "GRANT DELETE ON NODES CONTAINING LABELS :Label5 TO Boris;"
  - "GRANT UPDATE ON NODES CONTAINING LABELS :Label6 TO Boris;"
  - "GRANT CREATE ON NODES CONTAINING LABELS :Label7 TO Boris;"
  - "GRANT DELETE ON NODES CONTAINING LABELS :Label7 TO Boris;"
  - "GRANT NOTHING ON NODES CONTAINING LABELS :Label7 TO Boris;"
  - "Create User Niko;"
  - "Grant Auth TO Niko;"
  - "GRANT CREATE ON NODES CONTAINING LABELS * TO Niko;"
  - "GRANT DELETE ON NODES CONTAINING LABELS * TO Niko;"
  - "GRANT READ ON NODES CONTAINING LABELS * TO Niko;"
  - "Create User Bruno;"
  - "Grant Auth TO Bruno;"
  - "GRANT UPDATE ON NODES CONTAINING LABELS * TO Bruno;"

schema_info_setup_queries: &schema_info_setup_queries
  - "CREATE USER admin;"
  - "GRANT ALL PRIVILEGES TO admin;"
  - "GRANT CREATE ON NODES CONTAINING LABELS * TO admin;"
  - "GRANT DELETE ON NODES CONTAINING LABELS * TO admin;"
  - "GRANT CREATE ON EDGES CONTAINING TYPES * TO admin;"
  - "GRANT DELETE ON EDGES CONTAINING TYPES * TO admin;"
  - "CREATE USER josip;"
  - "GRANT STATS TO josip;"
  - "GRANT READ ON NODES CONTAINING LABELS * TO josip"
  - "GRANT READ ON EDGES CONTAINING TYPES * TO josip"
  - "CREATE USER toni;"
  - "GRANT STATS TO toni;"
  - "GRANT READ ON NODES CONTAINING LABELS * TO toni"
  - "CREATE USER buda;"
  - "GRANT STATS TO buda;"
  - "CREATE USER kate"
  - "GRANT READ ON NODES CONTAINING LABELS :Public TO kate"
  - "GRANT STATS TO kate;"
  - "CREATE USER matea"
  - "GRANT READ ON EDGES CONTAINING TYPES :TYPE TO matea"
  - "GRANT STATS TO matea;"


read_query_modules_in_memory_cluster: &read_query_modules_in_memory_cluster
  cluster:
    main:
      args: *args
      log_file: "lba-e2e.log"
      setup_queries: *query_modules_setup_queries
      validation_queries: []

update_query_modules_in_memory_cluster: &update_query_modules_in_memory_cluster
  cluster:
    main:
      args: *args
      log_file: "lba-e2e.log"
      setup_queries: *query_modules_setup_queries
      validation_queries: []

show_privileges_in_memory_cluster: &show_privileges_in_memory_cluster
  cluster:
    main:
      args: *args
      log_file: "lba-e2e.log"
      setup_queries: *show_privileges_setup_queries
      validation_queries: []

read_permission_in_memory_queries: &read_permission_in_memory_queries
  cluster:
    main:
      args: *args
      log_file: "lba-e2e.log"
      setup_queries: *query_modules_setup_queries
      validation_queries: []

create_delete_query_modules_in_memory_cluster: &create_delete_query_modules_in_memory_cluster
  cluster:
    main:
      args: *args
      log_file: "lba-e2e.log"
      setup_queries: *query_modules_setup_queries
      validation_queries: []

update_permission_queries_in_memory_cluster: &update_permission_queries_in_memory_cluster
  cluster:
    main:
      args: *args
      log_file: "lba-e2e.log"
      setup_queries: *query_modules_setup_queries
      validation_queries: []

schema_info_in_memory_queries: &schema_info_in_memory_queries
  cluster:
    main:
      args: *args
      log_file: "lba-e2e.log"
      setup_queries: *schema_info_setup_queries
      validation_queries: []

workloads:
  - name: "read-query-modules"
    binary: "tests/e2e/pytest_runner.sh"
    proc: "tests/e2e/lba_procedures/procedures/"
    args: ["lba_procedures/read_query_modules.py"]
    <<: *read_query_modules_in_memory_cluster

  - name: "update-query-modules"
    binary: "tests/e2e/pytest_runner.sh"
    proc: "tests/e2e/lba_procedures/procedures/"
    args: ["lba_procedures/update_query_modules.py"]
    <<: *update_query_modules_in_memory_cluster

  - name: "create-delete-query-modules"
    binary: "tests/e2e/pytest_runner.sh"
    proc: "tests/e2e/lba_procedures/procedures/"
    args: ["lba_procedures/create_delete_query_modules.py"]
    <<: *create_delete_query_modules_in_memory_cluster

  - name: "show-privileges"
    binary: "tests/e2e/pytest_runner.sh"
    proc: "tests/e2e/lba_procedures/procedures/"
    args: ["lba_procedures/show_privileges.py"]
    <<: *show_privileges_in_memory_cluster

  - name: "read-permission-queries"
    binary: "tests/e2e/pytest_runner.sh"
    proc: "tests/e2e/lba_procedures/procedures/"
    args: ["lba_procedures/read_permission_queries.py"]
    <<: *read_permission_in_memory_queries

  - name: "update-permission-queries"
    binary: "tests/e2e/pytest_runner.sh"
    proc: "tests/e2e/lba_procedures/procedures/"
    args: ["lba_procedures/update_permission_queries.py"]
    <<: *update_permission_queries_in_memory_cluster

  - name: "schema-info-queries-permission"
    binary: "tests/e2e/pytest_runner.sh"
    proc: "tests/e2e/lba_procedures/procedures/"
    args: ["lba_procedures/schema_info_queries_permission.py"]
    <<: *schema_info_in_memory_queries
