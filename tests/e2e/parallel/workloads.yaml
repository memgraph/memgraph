# Workload configuration for parallel e2e tests
#
# These tests are designed to run in parallel using pytest-xdist.
# Each test manages its own Memgraph instance via fixtures.
#
# Note: Unlike other e2e tests, parallel tests do NOT use the 'cluster' key
# because each pytest worker manages its own instance dynamically.
# Exception: test_procedures.py uses cluster-based approach to load procedures.

bolt_port: &bolt_port "7687"

# Cluster configuration for procedure tests (requires proc loading)
args_procedures: &args_procedures
  - "--bolt-port"
  - *bolt_port
  - "--log-level=TRACE"

procedure_cluster: &procedure_cluster
  cluster:
    main:
      args: *args_procedures
      log_file: "parallel-procedures-e2e.log"
      setup_queries: []
      validation_queries: []

workloads:
  - name: "Parallel e2e tests exceptions"
    binary: "tests/e2e/pytest_runner.sh"
    args: ["parallel/test_exceptions.py"]

  - name: "Parallel e2e tests fgac"
    binary: "tests/e2e/pytest_runner.sh"
    args: ["parallel/test_fgac.py"]

  - name: "Parallel e2e tests correctness"
    binary: "tests/e2e/pytest_runner.sh"
    args: ["parallel/test_parallel_correctness.py"]

  - name: "Parallel e2e tests hops limit"
    binary: "tests/e2e/pytest_runner.sh"
    args: ["parallel/test_hops_limit.py"]

  - name: "Parallel e2e tests explain"
    binary: "tests/e2e/pytest_runner.sh"
    args: ["parallel/test_explain.py"]

  - name: "Parallel e2e tests termination"
    binary: "tests/e2e/pytest_runner.sh"
    args: ["parallel/test_termination.py"]

  - name: "Parallel e2e tests frame change collector"
    binary: "tests/e2e/pytest_runner.sh"
    args: ["parallel/test_frame_change_collector.py"]

  - name: "Parallel e2e tests trigger context collector"
    binary: "tests/e2e/pytest_runner.sh"
    args: ["parallel/test_trigger_context_collector.py"]

  - name: "Parallel e2e tests profile"
    binary: "tests/e2e/pytest_runner.sh"
    args: ["parallel/test_profile.py"]

  - name: "Parallel e2e tests memory"
    binary: "tests/e2e/pytest_runner.sh"
    args: ["parallel/test_memory.py"]

  - name: "Parallel e2e tests procedures"
    binary: "tests/e2e/pytest_runner.sh"
    proc: "tests/e2e/parallel/procedures/"
    args: ["parallel/test_procedures.py"]
    <<: *procedure_cluster
