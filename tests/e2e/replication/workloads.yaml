template_test_nodes_query: &template_test_nodes_query
  - query: "MATCH (n) RETURN count(n);"
    expected: 1000
template_test_edge_query: &template_test_edges_query
  - query: "MATCH (n)-[r]->(m) RETURN count(r);"
    expected: 5000
template_validation_queries: &template_validation_queries
  validation_queries:
    - <<: *template_test_nodes_query
    - <<: *template_test_edges_query
template_cluster: &template_cluster
  cluster:
    replica_1:
      args: ["--bolt-port", "7688"]
      setup_queries: ["SET REPLICATION ROLE TO REPLICA WITH PORT 10001;"]
      <<: *template_validation_queries
    replica_2:
      args: ["--bolt-port", "7689"]
      setup_queries: ["SET REPLICATION ROLE TO REPLICA WITH PORT 10002;"]
      <<: *template_validation_queries
    replica_3:
      args: ["--bolt-port", "7690"]
      setup_queries: ["SET REPLICATION ROLE TO REPLICA WITH PORT 10003;"]
      <<: *template_validation_queries
    main:
      args: ["--main", "--bolt-port", "7687"]
      setup_queries: [
        "REGISTER REPLICA replica_1 SYNC WITH TIMEOUT 0 TO '127.0.0.1:10001'",
        "REGISTER REPLICA replica_2 SYNC WITH TIMEOUT 1 TO '127.0.0.1:10002'",
        "REGISTER REPLICA replica_3 ASYNC TO '127.0.0.1:10003'"
      ]
      <<: *template_validation_queries

workloads:
  - name: "Constraints"
    binary: "tests/e2e/replication/memgraph__e2e__replication__constraints"
    args: []
    <<: *template_cluster

  - name: "Read-write benchmark"
    binary: "tests/e2e/replication/memgraph__e2e__replication__read_write_benchmark"
    args: []
    <<: *template_cluster


