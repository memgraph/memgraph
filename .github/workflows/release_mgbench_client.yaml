name: "Mgbench Bolt Client Build and Publish Docker Image"
concurrency:
  group: ${{ github.workflow }}-${{ github.ref_name }}
  cancel-in-progress: true

on:
  workflow_dispatch:
    inputs:
      version:
        description: "Mgbench bolt client version to publish on Dockerhub."
        required: true
      push_to_dockerhub:
        type: boolean
        default: false
        description: "Push images to dockerhub"
      force_release:
        type: boolean
        required: false
        default: false

jobs:
  build_images:
    strategy:
      fail-fast: false
      matrix:
        arch: [amd, arm]
        image_type: [client, full]
    uses: ./.github/workflows/reusable_build_mgbench_client.yml
    with:
      arch:           ${{ matrix.arch }}
      version:        ${{ inputs.version }}
      push_to_dockerhub: ${{ inputs.push_to_dockerhub }}
      force_release:  ${{ inputs.force_release }}
      image_type:     ${{ matrix.image_type }}
    secrets: inherit
